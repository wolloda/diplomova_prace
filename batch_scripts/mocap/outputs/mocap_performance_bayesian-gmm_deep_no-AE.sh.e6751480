2021-03-25 14:24:46.183099: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:24:46.183418: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:24:46.183456: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
25-03-21 14:25 INFO: Loading faiss.
25-03-21 14:35 INFO: Loaded dataset of shape: (354902, 4099)
25-03-21 14:35 INFO: Dataset /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap loaded
2021-03-25 14:35:38 INFO: Benchmark initialized
25-03-21 14:35 INFO: Benchmark initialized
2021-03-25 14:35:38 INFO: Buckets: [10, 10, 10, 10, 10]
25-03-21 14:35 INFO: Buckets: [10, 10, 10, 10, 10]
2021-03-25 14:35:38 INFO: Total specs to train: 32
25-03-21 14:35 INFO: Total specs to train: 32
25-03-21 14:35 INFO: Training GMM model with values of shape (354902, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:48 INFO: Training level 1
25-03-21 14:48 INFO: Training GMM model with values of shape (7156, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:49 INFO: Training GMM model with values of shape (65749, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:51 INFO: Training GMM model with values of shape (26051, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:52 INFO: Training GMM model with values of shape (27310, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:53 INFO: Training GMM model with values of shape (55372, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:56 INFO: Training GMM model with values of shape (1855, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:56 INFO: Training GMM model with values of shape (39225, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:57 INFO: Training GMM model with values of shape (20219, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 14:58 INFO: Training GMM model with values of shape (72016, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:01 INFO: Training GMM model with values of shape (39949, 4096): n. of clusters=10 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
2021-03-25 15:03:17 INFO: BayesianGMM with training spec: {'BayesianGMM': [{'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 1658.765086747706 seconds (27.646084779128433 minutes)
25-03-21 15:03 INFO: BayesianGMM with training spec: {'BayesianGMM': [{'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 1658.765086747706 seconds (27.646084779128433 minutes)
Traceback (most recent call last):
  File "mocap_performance_bayesian-gmm_deep_no-AE.py", line 5, in <module>
    benchmark.evaluate()
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/Benchmark.py", line 271, in evaluate
    recall = evaluate_knn_per_query(search_result, df_result, knns)
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/knn_search.py", line 108, in evaluate_knn_per_query
    print(f"Evaluating k-NN performance on {len(res['objects_checkpoints'])} checkpoints: {res['objects_checkpoints']}")
KeyError: 'objects_checkpoints'
