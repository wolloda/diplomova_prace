2021-03-25 14:25:06.289669: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:25:06.300876: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:25:06.300922: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
25-03-21 14:25 INFO: Loading faiss.
25-03-21 14:36 INFO: Loaded dataset of shape: (354902, 4099)
25-03-21 14:36 INFO: Dataset /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap loaded
2021-03-25 14:36:32 INFO: Benchmark initialized
25-03-21 14:36 INFO: Benchmark initialized
2021-03-25 14:36:32 INFO: Buckets: [10, 10, 10, 10, 10]
25-03-21 14:36 INFO: Buckets: [10, 10, 10, 10, 10]
2021-03-25 14:36:32 INFO: Total specs to train: 24
25-03-21 14:36 INFO: Total specs to train: 24
25-03-21 14:36 INFO: Training GMM model with values of shape (354902, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:43 INFO: Training level 1
25-03-21 14:43 INFO: Training GMM model with values of shape (44506, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:44 INFO: Training GMM model with values of shape (60131, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:45 INFO: Training GMM model with values of shape (37959, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:45 INFO: Training GMM model with values of shape (29219, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:46 INFO: Training GMM model with values of shape (35492, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:46 INFO: Training GMM model with values of shape (13901, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:46 INFO: Training GMM model with values of shape (49711, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:47 INFO: Training GMM model with values of shape (37087, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:47 INFO: Training GMM model with values of shape (25561, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
25-03-21 14:48 INFO: Training GMM model with values of shape (21335, 4096): n. of clusters=10 | covariance type=spherical | max iterations=1 | initial parameters=kmeans
2021-03-25 14:48:55 INFO: GMM with training spec: {'GMM': [{'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 742.3079978842288 seconds (12.371799964737146 minutes)
25-03-21 14:48 INFO: GMM with training spec: {'GMM': [{'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}, {'comp': 10, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 742.3079978842288 seconds (12.371799964737146 minutes)
Traceback (most recent call last):
  File "mocap_performance_gmm_deep_no-AE.py", line 5, in <module>
    benchmark.evaluate()
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/Benchmark.py", line 271, in evaluate
    recall = evaluate_knn_per_query(search_result, df_result, knns)
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/knn_search.py", line 108, in evaluate_knn_per_query
    print(f"Evaluating k-NN performance on {len(res['objects_checkpoints'])} checkpoints: {res['objects_checkpoints']}")
KeyError: 'objects_checkpoints'
