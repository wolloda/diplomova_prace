2021-03-25 14:24:46.182657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:24:46.182987: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /software/cuda/10.1/cudnn/7.6.4/lib64:/software/cuda/10.1/lib64:/software/python-3.6.2/gcc/lib
2021-03-25 14:24:46.183023: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
25-03-21 14:25 INFO: Loading faiss.
25-03-21 14:35 INFO: Loaded dataset of shape: (354902, 4099)
25-03-21 14:35 INFO: Dataset /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap loaded
2021-03-25 14:35:31 INFO: Benchmark initialized
25-03-21 14:35 INFO: Benchmark initialized
2021-03-25 14:35:31 INFO: Buckets: [100, 100]
25-03-21 14:35 INFO: Buckets: [100, 100]
2021-03-25 14:35:31 INFO: Total specs to train: 32
25-03-21 14:35 INFO: Total specs to train: 32
25-03-21 14:35 INFO: Training GMM model with values of shape (354902, 4096): n. of clusters=100 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:08 INFO: Training level 1
25-03-21 15:08 INFO: Training GMM model with values of shape (94, 4096): n. of clusters=100 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:08 WARNING: Reducing the number of components from 100 to 47 since the number of                           training samples (94) is less than 100
25-03-21 15:08 INFO: Training GMM model with values of shape (5254, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:08 INFO: Training GMM model with values of shape (3168, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:08 INFO: Training GMM model with values of shape (84522, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:13 INFO: Training GMM model with values of shape (4632, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:13 INFO: Training GMM model with values of shape (4779, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:13 INFO: Training GMM model with values of shape (4799, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:14 INFO: Training GMM model with values of shape (296, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:14 INFO: Training GMM model with values of shape (5405, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:14 INFO: Training GMM model with values of shape (8155, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:14 INFO: Training GMM model with values of shape (956, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:14 INFO: Training GMM model with values of shape (6997, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (2641, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (77, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (2875, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (4458, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (584, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (3192, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:15 INFO: Training GMM model with values of shape (3145, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (4590, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (3835, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (3918, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (1099, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (108, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (2158, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:16 INFO: Training GMM model with values of shape (5773, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (642, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (539, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (1719, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (3229, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (3659, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (1085, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:17 INFO: Training GMM model with values of shape (6439, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (2499, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (936, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (1079, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (2239, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (3497, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (4551, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (2832, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (1511, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (598, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:18 INFO: Training GMM model with values of shape (868, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (5871, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (3266, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (3753, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (897, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (54, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (116, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (3040, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (728, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:19 INFO: Training GMM model with values of shape (3974, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (3733, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (211, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (669, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (74, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (5102, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (5517, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:20 INFO: Training GMM model with values of shape (2953, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (4424, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (239, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (4726, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (5, 4096): n. of clusters=47 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 WARNING: Reducing the number of components from 47 to 2 since the number of                           training samples (5) is less than 47
25-03-21 15:21 INFO: Training GMM model with values of shape (300, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (3965, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (2814, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (3395, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (762, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:21 INFO: Training GMM model with values of shape (4122, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (742, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (655, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (157, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (4012, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (3681, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (4966, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (516, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (7395, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (68, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:22 INFO: Training GMM model with values of shape (41301, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (860, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (1382, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (548, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (558, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (2396, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (642, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (48, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (55, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (2718, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (176, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (1731, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (4370, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (660, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
25-03-21 15:24 INFO: Training GMM model with values of shape (5123, 4096): n. of clusters=2 | covariance type=spherical | max_iter=1 | init_params=kmeans | weight_concentration_prior_type=dirichlet_process
2021-03-25 15:24:54 INFO: BayesianGMM with training spec: {'BayesianGMM': [{'comp': 100, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 2, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 2963.631463063881 seconds (49.39385771773134 minutes)
25-03-21 15:24 INFO: BayesianGMM with training spec: {'BayesianGMM': [{'comp': 100, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}, {'comp': 2, 'cov_type': 'spherical', 'max_iter': 1, 'init_params': 'kmeans', 'weight_concentration_prior_type': 'dirichlet_process'}]} trained on /storage/brno6/home/tslaninakova/learned-indexes/MTree1M-mocap in 2963.631463063881 seconds (49.39385771773134 minutes)
25-03-21 15:24 WARNING: (51,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (57,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (63,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (70,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (80,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (84,) is not in self.mapping[[0]].
25-03-21 15:24 WARNING: (92,) is not in self.mapping[[0]].
Traceback (most recent call last):
  File "mocap_performance_bayesian-gmm_wide_no-AE.py", line 5, in <module>
    benchmark.evaluate()
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/Benchmark.py", line 271, in evaluate
    recall = evaluate_knn_per_query(search_result, df_result, knns)
  File "/auto/brno6/home/wollf/learned-indexes/learned-indexes/knn_search.py", line 108, in evaluate_knn_per_query
    print(f"Evaluating k-NN performance on {len(res['objects_checkpoints'])} checkpoints: {res['objects_checkpoints']}")
KeyError: 'objects_checkpoints'
